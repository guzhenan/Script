# 文件清理工具

## 项目简介
这是一个功能强大的文件清理工具，可以帮助您自动清理指定目录中的过期文件。通过灵活的参数配置，支持按文件扩展名和修改时间进行筛选，并提供预览模式和定时任务功能，让文件管理变得更加简单高效。

## 功能特性
- 支持按文件扩展名筛选
- 支持按修改时间筛选
- 支持递归处理子目录
- 提供预览模式，防止误删
- 支持Windows计划任务，实现自动化清理
- 无需额外依赖，开箱即用

## 安装要求
- Python 3.6 或更高版本
- Windows操作系统（定时任务功能）
- 无需安装额外的Python包

## 使用说明

### 基本用法
1. 清理30天前的所有文件（包含子目录）：
```bash
python cleanup_script.py "F:\Downloads" -d 30 -r
```

2. 清理指定类型的文件：
```bash
# 清理所有.log和.tmp文件
python cleanup_script.py "D:\Logs" -e .log .tmp
```

3. 预览模式（不实际删除）：
```bash
python cleanup_script.py "C:\Temp" -d 7 -p
```

### 参数详解
```
必选参数:
  path            目标目录路径（必须是有效的目录路径）

可选参数:
  -e, --ext      按扩展名筛选（支持多个扩展名，用空格分隔）
  -d, --days     保留最近N天的文件（0表示不按时间筛选）
  -r, --recursive 递归处理子目录（默认不处理子目录）
  -p, --preview   预览模式，只显示要删除的文件列表
```

### 定时任务配置
在Windows系统中，您可以使用以下命令设置自动清理任务：

```powershell
# 创建每日自动清理任务（需要管理员权限）
schtasks /Create /TN 脚本名 /TR ""python.exe路径" "脚本所在路径" "目标路径" -d 7 -r" /SC DAILY /ST 12:00 /F

# 查看任务状态
schtasks /Query /TN "脚本名"

# 删除定时任务
schtasks /Delete /TN "AutoClean" /F
```

## 注意事项
1. 首次使用建议启用预览模式（-p），确认要删除的文件列表
2. 文件删除操作不可恢复，请谨慎操作
3. 配置定时任务时必须使用绝对路径
4. 建议将保留天数（-d）设置为3天以上
5. 处理系统目录时需要特别小心
6. 递归模式下处理大量文件可能需要较长时间

## 常见问题
1. **为什么需要管理员权限？**
   - 设置定时任务需要管理员权限
   - 清理系统目录时也可能需要管理员权限

2. **如何处理权限不足的问题？**
   - 使用管理员权限运行命令提示符
   - 确保当前用户对目标目录有写入权限

3. **如何中断正在执行的清理操作？**
   - 按Ctrl+C可以安全地中断操作
   - 中断操作不会影响已经删除的文件

## 贡献指南
欢迎提交问题报告和功能建议。如果您想贡献代码，请确保：
1. 代码符合Python PEP 8规范
2. 添加适当的注释和文档
3. 提交前进行充分测试